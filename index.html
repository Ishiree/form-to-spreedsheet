<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light bg-light mb-5">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Dropdown
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="#">Action</a>
                    <a class="dropdown-item" href="#">Another action</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">Something else here</a>
                  </div>
                </li>
                <li class="nav-item">
                  <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                </li>
              </ul>
              <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
              </form>
            </div>
          </nav>

          <div class="row justify-content-center">
              <div class="col-md-8">
                <div class="card">
                    <div class="card-body">
                      <!-- <div class="alert alert-success alert-dismissible fade show d-none my-alert" role="alert">
                        <strong>Terima kasih!</strong> Data Anda Sudah Tercatat
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div> -->
                        <form name="submit-to-google-sheet" id="submit-to-google-sheet">
                            <div class="form-group">
                              <label for="email">Email address</label>
                              <input name="email" type="email" class="form-control" id="email" require autofocus aria-describedby="emailHelp">
                              <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                            </div>
                            <div class="form-group">
                              <label for="name">Name</label>
                              <input name="name" type="text" class="form-control" id="name" require autofocus minlength="3">
                            </div>
                            <div class="form-group">
                              <label for="region">region</label>
                              <input name="region" type="text" class="form-control" id="region" require autofocus minlength="3">
                            </div>
                            <button id="submit-to-google-sheet" type="submit" class="btn btn-primary btn-send">Submit</button>
                            
                            <button class="btn btn-primary btn-loading d-none" type="button" disabled>
                              <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                              Loading...
                            </button>
                          </form>
                    </div>
                </div>
              </div>
          </div>
      </div>
    <!-- <script>
        $(document).ready(function() {
            $("#submit-to-google-sheet").validate({
                rules: {
                    email : {
                        required: true,
                        email: true
                   },
                    name: {
                        required: true,
                        min: 3
                    },
                    region: {
                        min: 3,
                        required: true,
                    },
                },
                submitHandler: function(form) {
                    form.submit();
                }
            });
        });
    </script> -->
    <!-- <script>
        $(document).ready(function(){

$('#submit-to-google-sheet').submit(function(e){
        e.preventDefault();
        $.confirm({
            title: 'Confirm!',
            content: 'Simple confirm!',
            buttons: {
                confirm: function () {
                    $.alert('Confirmed!');
                },
                cancel: function () {
                    $.alert('Canceled!');
                },
                somethingElse: {
                    text: 'Something else',
                    btnClass: 'btn-blue',
                    keys: ['enter', 'shift'],
                    action: function(){
                        $.alert('Something else?');
                    }
                }
            }
        });
    });
});
    </script> -->
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxRSdjWwLs83iIKGsE2CHtenoMMODZycG6SGb0gYoa9sARsNIMkDR6u8eceCdims0rP7Q/exec'
        const form = document.forms['submit-to-google-sheet'];
        const btnSend = document.querySelector('.btn-send');
        const btnLoading = document.querySelector('.btn-loading');
        const myAlert = document.querySelector('.my-alert');

        form.addEventListener('submit', e => {
          e.preventDefault()

          btnLoading.classList.toggle('d-none');
          btnSend.classList.toggle('d-none');
          fetch(scriptURL, { method: 'POST', body: new FormData(form)})
          .then(response => {
              btnLoading.classList.toggle('d-none');
              btnSend.classList.toggle('d-none');
              
              $.confirm({
                title: 'Berhasil!',
                content: 'Data Telah Disimpan',
                theme: 'modern',
                type: 'success',
                closeIcon: true,
                draggable: true,
                buttons: {
                    confirm: function () {
                        $.alert('Confirmed!');
                    },
                    cancel: function () {
                        $.alert('Canceled!');
                    },
                    somethingElse: {
                        text: 'Something else',
                        btnClass: 'btn-blue',
                        keys: ['enter', 'shift'],
                        action: function(){
                            $.alert('Something else?');
                        }
                    }
                }
              });

              form.reset();
              console.log('Success!', response)
          })
            .catch(error => console.error('Error!', error.message))
        })
      </script>
</body>
</html>